window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}();var Noc={Timer:{},Utils:{},Collision:{}};Noc.Collision.circularDetection=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.r+t.r;return i*i+r*r<=u*u};Noc.Audio=function(){function n(){var n=this;this.audioBuffers={};this.keys=[];this.context=new webkitAudioContext;this.load=function(t,i){this.keys.unshift(t);var r=new XMLHttpRequest;return r.open("GET",i,!0),r.responseType="arraybuffer",r.onload=function(){n.context.decodeAudioData(r.response,function(i){n.audioBuffers[t]=i;n.completed&&n.completed(t)},function(n){console.log(n)})},r.send(),this}}return n.prototype.completed=function(){},n.prototype.play=function(n,t){var i=this.context.createBufferSource();return i.buffer=this.audioBuffers[n],i.connect(this.context.destination),i.start(),t&&t(i),this},n.prototype.pause=function(){},n}();Noc.Utils={blendColors:function(n,t,i){var r=parseInt(n.slice(1),16),u=parseInt(t.slice(1),16),f=r>>16,e=r>>8&255,o=r&255,s=u>>16,h=u>>8&255,c=u&255;return"#"+(16777216+(Math.round((s-f)*i)+f)*65536+(Math.round((h-e)*i)+e)*256+(Math.round((c-o)*i)+o)).toString(16).slice(1)}};Noc.Timer.Fps=function(){var n=function(){this.elapsed=0;this.last=null};return n.prototype.tick=function(n){this.elapsed=n-(this.last||n)/1e3;this.last=n},n.prototype.current=function(){return Math.round(1/this.elapsed)},n}();Noc.Sprite=function(){function n(n,t,i,r,u,f,e){this.image=n;this.pos=t;this.size=i;this.speed=typeof r=="number"?r:0;this.frames=u;this._index=0;this.dir=f||"horizontal";this.once=e}return n.prototype.update=function(n){this._index+=this.speed*n},n.prototype.render=function(n){var t,i,r,u,f;if(this.speed>0){if(i=this.frames.length,r=Math.floor(this._index),t=this.frames[r%i],this.once&&r>=i){this.done=!0;return}}else t=0;u=this.pos[0];f=this.pos[1];this.dir=="vertical"?f+=t*this.size[1]:u+=t*this.size[0];n.drawImage(this.image,u,f,this.size[0],this.size[1],0,0,this.size[0],this.size[1])},n}();Noc.Images=function(){var n=function(){this.downloadQueue=[];this.successCount=0;this.errorCount=0;this.cache={}};return n.prototype.downloadAll=function(n){var t;for(this.downloadQueue.length===0&&n(),t=0;t<this.downloadQueue.length;t++){var u=this.downloadQueue[t],i=new Image,r=this;i.addEventListener("load",function(){r.successCount+=1;r.isDone()&&n()},!1);i.addEventListener("error",function(){r.errorCount+=1;r.isDone()&&n()},!1);i.src=u;this.cache[u]=i}},n.prototype.getAsset=function(n){return this.cache[n]},n.prototype.isDone=function(){return this.downloadQueue.length==this.successCount+this.errorCount},n}();Noc.Assets=function(){var n=function(n,t){var i=this;this.imageAssets=new Noc.Images;this.audioAssets=new Noc.Audio;n.images.forEach(function(n){i.imageAssets.downloadQueue.push(n)});this.imageAssets.downloadAll(function(){t&&t()})};return n.prototype.getImage=function(n){return this.imageAssets.cache[n]},n}();Noc.Engine=function(){var n=function(n,t){var i,r,u;this.parent=t;this.entities={};i=this;this.isReady=!1;this.viewport={canvas:undefined,height:0,width:0,ctx:undefined};this.viewport.canvas=document.querySelector(n);this.viewport.width=t?t.clientWidth:window.innerWidth;this.viewport.height=t?t.clientHeight:window.innerHeight;this.viewport.ctx=this.viewport.canvas.getContext("2d");this.viewport.mouse=undefined;this.clear=function(){i.viewport.ctx.clearRect(0,0,this.viewport.width,this.viewport.height)};r=Date.now();u=function(n){i.clear();var t=Date.now(),u=(t-r)/1e3;Object.keys(i.entities).forEach(function(t){var r=i.entities[t];if(r.onRender)r.onRender(r.state,t);if(r.collidesWith.forEach(function(n){var t=[];for(var u in i.entities)i.entities[u].type===n&&t.push(i.entities[u].key);t.forEach(function(n){var t=i.entities[n].collitionExpression(i.entities[n].state),u=r.collitionExpression(r.state),f=Noc.Collision.circularDetection(t,u);if(f)i.entities[n].onCollition(i.entities[n].key,r.key)})}),r.draw(i.viewport,u),r.lifetime&&n>r.lifetime&&r.onlifetimeend){r.active=!1;r.onlifetimeend(r.key,n)}});r=t};window.addEventListener("resize",function(n){i.parent?(i.viewport.height=i.parent.clientHeight,i.viewport.width=i.parent.clientWidth):(i.viewport.height=n.target.innerHeight,i.viewport.width=n.target.innerWidth);i.viewport.canvas.height=i.viewport.height;i.viewport.canvas.width=i.viewport.width},!1),function f(n){requestAnimFrame(f);i.isReady&&u(n);i.timeElapsed=n}();this.resize=function(){var n=document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,window,0);window.dispatchEvent(n)};i.resize();this.viewport.canvas.addEventListener("mousemove",function(n){i.viewport.mouse=n})};return n.prototype.addEntity=function(n,t){return this.entities.hasOwnProperty(n.key)||(this.entities[n.key]=n),this.entities[n.key].lifetime+=this.timeElapsed||0,t&&t(),this},n.prototype.start=function(){this.isReady=!this.isReady},n.prototype.removeEntity=function(n,t){return this.entities.hasOwnProperty(n)&&delete this.entities[n],t&&t(),this},n}();Noc.Entity=function(){var n=function(n,t,i,r){this.fps=new Noc.Timer.Fps;this.type="";this.active=!0;this.state={};this.render=t;this.key=n;this.visible=!0;this.push=i|0;this.lifetime=r;this.onRender=undefined;this.toggle=function(){this.visible=!this.visible};this.init=function(n){return this.state=n,this};this.onlifetimeend=undefined;this.collidesWith=[];this.collitionExpression=undefined;this.detectCollitions=function(n,t){this.collitionExpression=t;this.collidesWith=n};this.onCollition=undefined};return n.prototype.draw=function(n,t){this.render(n,t);this.fps.tick(t);this.fps.current()%2==1&&this.capture&&this.capture(this.state)},n}();
/*
//# sourceMappingURL=Noc.beta.min.js.map
*/